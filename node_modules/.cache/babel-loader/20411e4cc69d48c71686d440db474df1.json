{"ast":null,"code":"import _objectSpread from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { find, filter } from 'lodash-es';\nimport { SERVICES_REQUEST, SERVICES_SUCCESS, SERVICES_FAILURE, CUSTOM_RESOURCE_LIST_SUCCESS, CUSTOM_RESOURCE_ADDED_SUCCESS, CUSTOM_RESOURCE_DELETED_SUCCESS, CUSTOM_RESOURCE_MODIFIED_SUCCESS } from '../actions/services';\nvar defaultState = {\n  isFetching: false,\n  items: [],\n  isCreating: false,\n  isDeleting: false,\n  isActioning: false,\n  isReading: false\n};\n\nfunction addOrReplaceItem(array, item, predicate) {\n  var index = array.findIndex(predicate);\n\n  if (index >= 0) {\n    return [].concat(_toConsumableArray(array.slice(0, index)), [item], _toConsumableArray(array.slice(index + 1)));\n  }\n\n  return [].concat(_toConsumableArray(array), [item]);\n}\n\nfunction sameService(oldService, newService) {\n  return oldService.name === newService.name;\n}\n\nfunction sameCustomResource(oldCR, newCR) {\n  return oldCR.metadata.name === newCR.metadata.name;\n}\n\nvar resourceReducer = function resourceReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SERVICES_REQUEST:\n      return _objectSpread({}, state, {\n        isFetching: true\n      });\n\n    case SERVICES_SUCCESS:\n      return _objectSpread({}, state, {\n        isFetching: false,\n        items: action.result.items\n      });\n\n    case SERVICES_FAILURE:\n      return _objectSpread({}, state, {\n        isFetching: false\n      });\n\n    case CUSTOM_RESOURCE_LIST_SUCCESS:\n      {\n        var service = action.service,\n            items = action.items;\n        service.customResources = items;\n        return _objectSpread({}, state, {\n          items: addOrReplaceItem(state.items, service, function (item) {\n            return sameService(item, service);\n          })\n        });\n      }\n\n    case CUSTOM_RESOURCE_ADDED_SUCCESS:\n    case CUSTOM_RESOURCE_MODIFIED_SUCCESS:\n      {\n        var _service = action.service,\n            result = action.result;\n        var existingService = find(state.items, function (s) {\n          return sameService(s, _service);\n        });\n\n        if (existingService) {\n          existingService.customResources = addOrReplaceItem(existingService.customResources, result, function (c) {\n            return sameCustomResource(c, result);\n          });\n        }\n\n        return _objectSpread({}, state);\n      }\n\n    case CUSTOM_RESOURCE_DELETED_SUCCESS:\n      {\n        var _service2 = action.service,\n            _result = action.result;\n\n        var _existingService = find(state.items, function (s) {\n          return sameService(s, _service2);\n        });\n\n        if (_existingService) {\n          _existingService.customResources = filter(_existingService.customResources, function (c) {\n            return !sameCustomResource(c, _result);\n          });\n        }\n\n        return _objectSpread({}, state);\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default resourceReducer;","map":{"version":3,"sources":["/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/src/reducers/services.js"],"names":["find","filter","SERVICES_REQUEST","SERVICES_SUCCESS","SERVICES_FAILURE","CUSTOM_RESOURCE_LIST_SUCCESS","CUSTOM_RESOURCE_ADDED_SUCCESS","CUSTOM_RESOURCE_DELETED_SUCCESS","CUSTOM_RESOURCE_MODIFIED_SUCCESS","defaultState","isFetching","items","isCreating","isDeleting","isActioning","isReading","addOrReplaceItem","array","item","predicate","index","findIndex","slice","sameService","oldService","newService","name","sameCustomResource","oldCR","newCR","metadata","resourceReducer","state","action","type","result","service","customResources","existingService","s","c"],"mappings":"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","sourcesContent":["import { find, filter } from 'lodash-es';\nimport {\n  SERVICES_REQUEST,\n  SERVICES_SUCCESS,\n  SERVICES_FAILURE,\n  CUSTOM_RESOURCE_LIST_SUCCESS,\n  CUSTOM_RESOURCE_ADDED_SUCCESS,\n  CUSTOM_RESOURCE_DELETED_SUCCESS,\n  CUSTOM_RESOURCE_MODIFIED_SUCCESS\n} from '../actions/services';\n\nconst defaultState = {\n  isFetching: false,\n  items: [],\n  isCreating: false,\n  isDeleting: false,\n  isActioning: false,\n  isReading: false\n};\n\nfunction addOrReplaceItem(array, item, predicate) {\n  const index = array.findIndex(predicate);\n  if (index >= 0) {\n    return [...array.slice(0, index), item, ...array.slice(index + 1)];\n  }\n  return [...array, item];\n}\n\nfunction sameService(oldService, newService) {\n  return oldService.name === newService.name;\n}\n\nfunction sameCustomResource(oldCR, newCR) {\n  return oldCR.metadata.name === newCR.metadata.name;\n}\n\nconst resourceReducer = (state = defaultState, action) => {\n  switch (action.type) {\n    case SERVICES_REQUEST:\n      return {\n        ...state,\n        isFetching: true\n      };\n    case SERVICES_SUCCESS:\n      return {\n        ...state,\n        isFetching: false,\n        items: action.result.items\n      };\n    case SERVICES_FAILURE:\n      return {\n        ...state,\n        isFetching: false\n      };\n    case CUSTOM_RESOURCE_LIST_SUCCESS: {\n      const { service, items } = action;\n      service.customResources = items;\n      return {\n        ...state,\n        items: addOrReplaceItem(state.items, service, item => sameService(item, service))\n      };\n    }\n    case CUSTOM_RESOURCE_ADDED_SUCCESS:\n    case CUSTOM_RESOURCE_MODIFIED_SUCCESS: {\n      const { service, result } = action;\n      const existingService = find(state.items, s => sameService(s, service));\n      if (existingService) {\n        existingService.customResources = addOrReplaceItem(existingService.customResources, result, c =>\n          sameCustomResource(c, result)\n        );\n      }\n      return {\n        ...state\n      };\n    }\n    case CUSTOM_RESOURCE_DELETED_SUCCESS: {\n      const { service, result } = action;\n      const existingService = find(state.items, s => sameService(s, service));\n      if (existingService) {\n        existingService.customResources = filter(existingService.customResources, c => !sameCustomResource(c, result));\n      }\n      return {\n        ...state\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nexport default resourceReducer;\n"]},"metadata":{},"sourceType":"module"}