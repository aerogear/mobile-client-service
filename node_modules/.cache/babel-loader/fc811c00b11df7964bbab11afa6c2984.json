{"ast":null,"code":"import _classCallCheck from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/src/components/build/MobileClientBuildListItem.js\";\nimport React, { Component } from 'react';\nimport { DropdownKebab, MenuItem, Button, Row, Col } from 'patternfly-react';\nimport BuildStatus from '../common/BuildStatus';\nimport MobileListViewItem from '../common/MobileListViewItem';\nimport BuildConfigDetails from './BuildConfigDetails';\nimport ComponentSectionLabel from '../common/ComponentSectionLabel';\nimport MobileClientBuildHistoryList from './MobileClientBuildHistoryList';\nimport BuildInformation from './BuildInformation';\nimport NoBuild from './NoBuild';\nimport StartBuildButton from '../../containers/StartBuildButton';\nimport DeleteItemButton from '../../containers/DeleteItemButton';\nimport './MobileClientBuildListItem.css';\n\nvar actions = function actions(id) {\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15\n    },\n    __self: this\n  }, React.createElement(StartBuildButton, {\n    jobName: id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }), React.createElement(DropdownKebab, {\n    id: \"build-actions-\".concat(id),\n    pullRight: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 17\n    },\n    __self: this\n  }, React.createElement(MenuItem, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18\n    },\n    __self: this\n  }, \"Edit\"), React.createElement(DeleteItemButton, {\n    itemName: id,\n    itemType: \"buildconfig\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19\n    },\n    __self: this\n  })));\n};\n\nvar buildConfig = function buildConfig(buildConfiguration) {\n  return {\n    jenkinsfilePath: buildConfiguration.spec.strategy.jenkinsPipelineStrategy.jenkinsfilePath,\n    jobName: buildConfiguration.metadata.name,\n    // TODO: consider other sources other than git as well\n    branch: buildConfiguration.spec.source.git.ref || 'master',\n    repoUrl: buildConfiguration.spec.source.git.uri\n  };\n};\n\nvar buildNumber = function buildNumber(build) {\n  return build && Number(build.metadata.annotations['openshift.io/build.number']);\n};\n\nvar lastBuild = function lastBuild(builds) {\n  return builds.reduce(function (acc, curr) {\n    return buildNumber(curr) > buildNumber(acc) ? curr : acc;\n  }, null);\n};\n\nvar buildHistory = function buildHistory(builds) {\n  var lastBuildNumber = buildNumber(lastBuild(builds));\n  return builds.filter(function (build) {\n    return buildNumber(build) !== lastBuildNumber;\n  }).sort(function (a, b) {\n    return buildNumber(b) - buildNumber(a);\n  });\n};\n\nvar heading = function heading(name, latestBuild) {\n  return React.createElement(\"div\", {\n    className: \"pull-left text-left mobile-client-build-listitem-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }, latestBuild && React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, React.createElement(BuildStatus, {\n    build: latestBuild,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }), ' '), React.createElement(Button, {\n    bsStyle: \"link\",\n    className: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, name)));\n};\n\nvar MobileClientBuildListItem =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MobileClientBuildListItem, _Component);\n\n  function MobileClientBuildListItem(props) {\n    var _this;\n\n    _classCallCheck(this, MobileClientBuildListItem);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MobileClientBuildListItem).call(this, props));\n\n    _this.render = function () {\n      var _this$props = _this.props,\n          buildConfiguration = _this$props.buildConfiguration,\n          appName = _this$props.appName;\n      var buildConfigName = buildConfiguration.metadata.name;\n      var builds = buildConfiguration.builds || [];\n      var lastClientBuild = lastBuild(builds);\n      var clientBuildHistory = buildHistory(builds);\n      var buildConfigDetails = buildConfig(buildConfiguration);\n      return React.createElement(MobileListViewItem, {\n        className: \"build-item\",\n        actions: actions(buildConfigName),\n        checkboxInput: false,\n        heading: heading(buildConfigName, lastClientBuild),\n        hideCloseIcon: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(ComponentSectionLabel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"Build Config\"), React.createElement(BuildConfigDetails, {\n        buildConfig: buildConfigDetails,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }))), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(ComponentSectionLabel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, \"Builds\"), builds.length === 0 ? React.createElement(NoBuild, {\n        buildConfig: buildConfigDetails,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }) : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, React.createElement(BuildInformation, {\n        appName: appName,\n        build: lastClientBuild,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }), clientBuildHistory.length > 0 ? React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"mobile-chevron\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(Button, {\n        onClick: function onClick(e) {\n          e.preventDefault();\n\n          _this.setState({\n            buildHistoryOpen: !_this.state.buildHistoryOpen\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: _this.state.buildHistoryOpen ? 'fa fa-angle-down' : 'fa fa-angle-right',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }), \"\\xA0\", _this.state.buildHistoryOpen ? 'Hide' : 'Show', \" build history\")), _this.state.buildHistoryOpen ? React.createElement(MobileClientBuildHistoryList, {\n        appName: appName,\n        className: \"collapse in\",\n        id: \"demo\",\n        mobileClientBuilds: clientBuildHistory,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }) : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }))) : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      })))));\n    };\n\n    _this.state = {\n      isHidden: true\n    };\n    return _this;\n  }\n\n  _createClass(MobileClientBuildListItem, [{\n    key: \"toggleHidden\",\n    value: function toggleHidden() {\n      this.setState({\n        isHidden: !this.state.isHidden\n      });\n    }\n  }, {\n    key: \"historyButton\",\n    value: function historyButton() {\n      if (this.state.isHidden) {\n        return React.createElement(Button, {\n          bsStyle: \"link\",\n          onClick: this.toggleHidden,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"fa fa-angle-right fa-fw\",\n          \"aria-hidden\": \"true\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }), \" Show Build History\");\n      }\n\n      return React.createElement(Button, {\n        bsStyle: \"link\",\n        onClick: this.toggleHidden,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"fa fa-angle-down fa-fw\",\n        \"aria-hidden\": \"true\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }), \" Hide Build History\");\n    }\n  }]);\n\n  return MobileClientBuildListItem;\n}(Component);\n\nexport default MobileClientBuildListItem;","map":{"version":3,"sources":["/Users/weili/work/mobile-next/golang/src/github.com/aerogear/mobile-developer-console/src/components/build/MobileClientBuildListItem.js"],"names":["React","Component","DropdownKebab","MenuItem","Button","Row","Col","BuildStatus","MobileListViewItem","BuildConfigDetails","ComponentSectionLabel","MobileClientBuildHistoryList","BuildInformation","NoBuild","StartBuildButton","DeleteItemButton","actions","id","buildConfig","buildConfiguration","jenkinsfilePath","spec","strategy","jenkinsPipelineStrategy","jobName","metadata","name","branch","source","git","ref","repoUrl","uri","buildNumber","build","Number","annotations","lastBuild","builds","reduce","acc","curr","buildHistory","lastBuildNumber","filter","sort","a","b","heading","latestBuild","MobileClientBuildListItem","props","render","appName","buildConfigName","lastClientBuild","clientBuildHistory","buildConfigDetails","length","e","preventDefault","setState","buildHistoryOpen","state","isHidden","toggleHidden"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,aAAT,EAAwBC,QAAxB,EAAkCC,MAAlC,EAA0CC,GAA1C,EAA+CC,GAA/C,QAA0D,kBAA1D;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AACA,OAAOC,kBAAP,MAA+B,8BAA/B;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AACA,OAAOC,qBAAP,MAAkC,iCAAlC;AACA,OAAOC,4BAAP,MAAyC,gCAAzC;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,gBAAP,MAA6B,mCAA7B;AACA,OAAOC,gBAAP,MAA6B,mCAA7B;AACA,OAAO,iCAAP;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAAAC,EAAE;AAAA,SAChB,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,gBAAD;AAAkB,IAAA,OAAO,EAAEA,EAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,oBAAC,aAAD;AAAe,IAAA,EAAE,0BAAmBA,EAAnB,CAAjB;AAA0C,IAAA,SAAS,MAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,EAEE,oBAAC,gBAAD;AAAkB,IAAA,QAAQ,EAAEA,EAA5B;AAAgC,IAAA,QAAQ,EAAC,aAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAFF,CADgB;AAAA,CAAlB;;AAUA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAAC,kBAAkB;AAAA,SAAK;AACzCC,IAAAA,eAAe,EAAED,kBAAkB,CAACE,IAAnB,CAAwBC,QAAxB,CAAiCC,uBAAjC,CAAyDH,eADjC;AAEzCI,IAAAA,OAAO,EAAEL,kBAAkB,CAACM,QAAnB,CAA4BC,IAFI;AAGzC;AACAC,IAAAA,MAAM,EAAER,kBAAkB,CAACE,IAAnB,CAAwBO,MAAxB,CAA+BC,GAA/B,CAAmCC,GAAnC,IAA0C,QAJT;AAKzCC,IAAAA,OAAO,EAAEZ,kBAAkB,CAACE,IAAnB,CAAwBO,MAAxB,CAA+BC,GAA/B,CAAmCG;AALH,GAAL;AAAA,CAAtC;;AAQA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAAC,KAAK;AAAA,SAAIA,KAAK,IAAIC,MAAM,CAACD,KAAK,CAACT,QAAN,CAAeW,WAAf,CAA2B,2BAA3B,CAAD,CAAnB;AAAA,CAAzB;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAAAC,MAAM;AAAA,SAAIA,MAAM,CAACC,MAAP,CAAc,UAACC,GAAD,EAAMC,IAAN;AAAA,WAAgBR,WAAW,CAACQ,IAAD,CAAX,GAAoBR,WAAW,CAACO,GAAD,CAA/B,GAAuCC,IAAvC,GAA8CD,GAA9D;AAAA,GAAd,EAAkF,IAAlF,CAAJ;AAAA,CAAxB;;AAEA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAAAJ,MAAM,EAAI;AAC7B,MAAMK,eAAe,GAAGV,WAAW,CAACI,SAAS,CAACC,MAAD,CAAV,CAAnC;AACA,SAAOA,MAAM,CAACM,MAAP,CAAc,UAAAV,KAAK;AAAA,WAAID,WAAW,CAACC,KAAD,CAAX,KAAuBS,eAA3B;AAAA,GAAnB,EAA+DE,IAA/D,CAAoE,UAACC,CAAD,EAAIC,CAAJ;AAAA,WAAUd,WAAW,CAACc,CAAD,CAAX,GAAiBd,WAAW,CAACa,CAAD,CAAtC;AAAA,GAApE,CAAP;AACD,CAHD;;AAKA,IAAME,OAAO,GAAG,SAAVA,OAAU,CAACtB,IAAD,EAAOuB,WAAP;AAAA,SACd;AAAK,IAAA,SAAS,EAAC,yDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGA,WAAW,IACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,WAAD;AAAa,IAAA,KAAK,EAAEA,WAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EACsC,GADtC,CAFJ,EAME,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,MAAhB;AAAuB,IAAA,SAAS,EAAC,MAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOvB,IAAP,CADF,CANF,CADc;AAAA,CAAhB;;IAaMwB,yB;;;;;AACJ,qCAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,mGAAMA,KAAN;;AADiB,UA6BnBC,MA7BmB,GA6BV,YAAM;AAAA,wBAC2B,MAAKD,KADhC;AAAA,UACLhC,kBADK,eACLA,kBADK;AAAA,UACekC,OADf,eACeA,OADf;AAEb,UAAMC,eAAe,GAAGnC,kBAAkB,CAACM,QAAnB,CAA4BC,IAApD;AACA,UAAMY,MAAM,GAAGnB,kBAAkB,CAACmB,MAAnB,IAA6B,EAA5C;AACA,UAAMiB,eAAe,GAAGlB,SAAS,CAACC,MAAD,CAAjC;AACA,UAAMkB,kBAAkB,GAAGd,YAAY,CAACJ,MAAD,CAAvC;AACA,UAAMmB,kBAAkB,GAAGvC,WAAW,CAACC,kBAAD,CAAtC;AAEA,aACE,oBAAC,kBAAD;AACE,QAAA,SAAS,EAAC,YADZ;AAEE,QAAA,OAAO,EAAEH,OAAO,CAACsC,eAAD,CAFlB;AAGE,QAAA,aAAa,EAAE,KAHjB;AAIE,QAAA,OAAO,EAAEN,OAAO,CAACM,eAAD,EAAkBC,eAAlB,CAJlB;AAKE,QAAA,aAAa,MALf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,EAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,qBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,EAEE,oBAAC,kBAAD;AAAoB,QAAA,WAAW,EAAEE,kBAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CADF,CAPF,EAaE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,EAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,qBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAEGnB,MAAM,CAACoB,MAAP,KAAkB,CAAlB,GACC,oBAAC,OAAD;AAAS,QAAA,WAAW,EAAED,kBAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADD,GAGC,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,gBAAD;AAAkB,QAAA,OAAO,EAAEJ,OAA3B;AAAoC,QAAA,KAAK,EAAEE,eAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEGC,kBAAkB,CAACE,MAAnB,GAA4B,CAA5B,GACC,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,EAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AACE,QAAA,OAAO,EAAE,iBAAAC,CAAC,EAAI;AACZA,UAAAA,CAAC,CAACC,cAAF;;AACA,gBAAKC,QAAL,CAAc;AAAEC,YAAAA,gBAAgB,EAAE,CAAC,MAAKC,KAAL,CAAWD;AAAhC,WAAd;AACD,SAJH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAME;AAAM,QAAA,SAAS,EAAE,MAAKC,KAAL,CAAWD,gBAAX,GAA8B,kBAA9B,GAAmD,mBAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QANF,UAQG,MAAKC,KAAL,CAAWD,gBAAX,GAA8B,MAA9B,GAAuC,MAR1C,mBADF,CADF,EAaG,MAAKC,KAAL,CAAWD,gBAAX,GACC,oBAAC,4BAAD;AACE,QAAA,OAAO,EAAET,OADX;AAEE,QAAA,SAAS,EAAC,aAFZ;AAGE,QAAA,EAAE,EAAC,MAHL;AAIE,QAAA,kBAAkB,EAAEG,kBAJtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADD,GAQC,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QArBJ,CADF,CADD,GA4BC,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA9BJ,CALJ,CADF,CAbF,CADF;AA0DD,KA/FkB;;AAGjB,UAAKO,KAAL,GAAa;AACXC,MAAAA,QAAQ,EAAE;AADC,KAAb;AAHiB;AAMlB;;;;mCAEc;AACb,WAAKH,QAAL,CAAc;AACZG,QAAAA,QAAQ,EAAE,CAAC,KAAKD,KAAL,CAAWC;AADV,OAAd;AAGD;;;oCAEe;AACd,UAAI,KAAKD,KAAL,CAAWC,QAAf,EAAyB;AACvB,eACE,oBAAC,MAAD;AAAQ,UAAA,OAAO,EAAC,MAAhB;AAAuB,UAAA,OAAO,EAAE,KAAKC,YAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAM,UAAA,SAAS,EAAC,yBAAhB;AAA0C,yBAAY,MAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,wBADF;AAKD;;AACD,aACE,oBAAC,MAAD;AAAQ,QAAA,OAAO,EAAC,MAAhB;AAAuB,QAAA,OAAO,EAAE,KAAKA,YAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,wBAAhB;AAAyC,uBAAY,MAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,wBADF;AAKD;;;;EA5BqChE,S;;AAmGxC,eAAeiD,yBAAf","sourcesContent":["import React, { Component } from 'react';\nimport { DropdownKebab, MenuItem, Button, Row, Col } from 'patternfly-react';\nimport BuildStatus from '../common/BuildStatus';\nimport MobileListViewItem from '../common/MobileListViewItem';\nimport BuildConfigDetails from './BuildConfigDetails';\nimport ComponentSectionLabel from '../common/ComponentSectionLabel';\nimport MobileClientBuildHistoryList from './MobileClientBuildHistoryList';\nimport BuildInformation from './BuildInformation';\nimport NoBuild from './NoBuild';\nimport StartBuildButton from '../../containers/StartBuildButton';\nimport DeleteItemButton from '../../containers/DeleteItemButton';\nimport './MobileClientBuildListItem.css';\n\nconst actions = id => (\n  <React.Fragment>\n    <StartBuildButton jobName={id} />\n    <DropdownKebab id={`build-actions-${id}`} pullRight>\n      <MenuItem>Edit</MenuItem>\n      <DeleteItemButton itemName={id} itemType=\"buildconfig\" />\n    </DropdownKebab>\n  </React.Fragment>\n);\n\nconst buildConfig = buildConfiguration => ({\n  jenkinsfilePath: buildConfiguration.spec.strategy.jenkinsPipelineStrategy.jenkinsfilePath,\n  jobName: buildConfiguration.metadata.name,\n  // TODO: consider other sources other than git as well\n  branch: buildConfiguration.spec.source.git.ref || 'master',\n  repoUrl: buildConfiguration.spec.source.git.uri\n});\n\nconst buildNumber = build => build && Number(build.metadata.annotations['openshift.io/build.number']);\n\nconst lastBuild = builds => builds.reduce((acc, curr) => (buildNumber(curr) > buildNumber(acc) ? curr : acc), null);\n\nconst buildHistory = builds => {\n  const lastBuildNumber = buildNumber(lastBuild(builds));\n  return builds.filter(build => buildNumber(build) !== lastBuildNumber).sort((a, b) => buildNumber(b) - buildNumber(a));\n};\n\nconst heading = (name, latestBuild) => (\n  <div className=\"pull-left text-left mobile-client-build-listitem-header\">\n    {latestBuild && (\n      <span>\n        <BuildStatus build={latestBuild} />{' '}\n      </span>\n    )}\n    <Button bsStyle=\"link\" className=\"name\">\n      <span>{name}</span>\n    </Button>\n  </div>\n);\n\nclass MobileClientBuildListItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isHidden: true\n    };\n  }\n\n  toggleHidden() {\n    this.setState({\n      isHidden: !this.state.isHidden\n    });\n  }\n\n  historyButton() {\n    if (this.state.isHidden) {\n      return (\n        <Button bsStyle=\"link\" onClick={this.toggleHidden}>\n          <span className=\"fa fa-angle-right fa-fw\" aria-hidden=\"true\" /> Show Build History\n        </Button>\n      );\n    }\n    return (\n      <Button bsStyle=\"link\" onClick={this.toggleHidden}>\n        <span className=\"fa fa-angle-down fa-fw\" aria-hidden=\"true\" /> Hide Build History\n      </Button>\n    );\n  }\n\n  render = () => {\n    const { buildConfiguration, appName } = this.props;\n    const buildConfigName = buildConfiguration.metadata.name;\n    const builds = buildConfiguration.builds || [];\n    const lastClientBuild = lastBuild(builds);\n    const clientBuildHistory = buildHistory(builds);\n    const buildConfigDetails = buildConfig(buildConfiguration);\n\n    return (\n      <MobileListViewItem\n        className=\"build-item\"\n        actions={actions(buildConfigName)}\n        checkboxInput={false}\n        heading={heading(buildConfigName, lastClientBuild)}\n        hideCloseIcon\n      >\n        <Row>\n          <Col md={12}>\n            <ComponentSectionLabel>Build Config</ComponentSectionLabel>\n            <BuildConfigDetails buildConfig={buildConfigDetails} />\n          </Col>\n        </Row>\n        <Row>\n          <Col md={12}>\n            <ComponentSectionLabel>Builds</ComponentSectionLabel>\n            {builds.length === 0 ? (\n              <NoBuild buildConfig={buildConfigDetails} />\n            ) : (\n              <React.Fragment>\n                <BuildInformation appName={appName} build={lastClientBuild} />\n                {clientBuildHistory.length > 0 ? (\n                  <Row>\n                    <Col md={12}>\n                      <div className=\"mobile-chevron\">\n                        <Button\n                          onClick={e => {\n                            e.preventDefault();\n                            this.setState({ buildHistoryOpen: !this.state.buildHistoryOpen });\n                          }}\n                        >\n                          <span className={this.state.buildHistoryOpen ? 'fa fa-angle-down' : 'fa fa-angle-right'} />\n                          &nbsp;\n                          {this.state.buildHistoryOpen ? 'Hide' : 'Show'} build history\n                        </Button>\n                      </div>\n                      {this.state.buildHistoryOpen ? (\n                        <MobileClientBuildHistoryList\n                          appName={appName}\n                          className=\"collapse in\"\n                          id=\"demo\"\n                          mobileClientBuilds={clientBuildHistory}\n                        />\n                      ) : (\n                        <React.Fragment />\n                      )}\n                    </Col>\n                  </Row>\n                ) : (\n                  <React.Fragment />\n                )}\n              </React.Fragment>\n            )}\n          </Col>\n        </Row>\n      </MobileListViewItem>\n    );\n  };\n}\n\nexport default MobileClientBuildListItem;\n"]},"metadata":{},"sourceType":"module"}